<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Finanz-T√úV</title>
  <style>
    :root{
      --bg:#0b1220; --panel:rgba(255,255,255,.06); --ink:#e5e7eb; --muted:#94a3b8; --ring:rgba(255,255,255,.12);
      --brand:#22d3ee; --good:#10b981; --warn:#f59e0b; --bad:#ef4444;
    }
    body{margin:0;font-family:sans-serif;background:var(--bg);color:var(--ink);}
    h1,h2{margin:0}
    button{cursor:pointer}
    .page{display:none;padding:20px;max-width:600px;margin:auto}
    .active{display:block}
    .center{text-align:center}
    .panel{background:var(--panel);padding:20px;border-radius:12px;margin:20px 0}
    label{display:block;margin:10px 0 4px}
    input{width:100%;padding:10px;border-radius:8px;border:1px solid var(--ring);background:transparent;color:var(--ink)}
    .nav{display:flex;justify-content:space-between;margin-top:20px}
    .btn{padding:10px 20px;border:none;border-radius:8px;background:var(--brand);color:#000;font-weight:600}
    .kpis{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px}
    .kpi{background:var(--panel);padding:12px;border-radius:10px;text-align:center}
    .lab{font-size:12px;color:var(--muted)}
    .val{font-size:18px;font-weight:bold}
    canvas{max-width:100%}
  </style>
</head>
<body>

<!-- Landing -->
<div id="landing" class="page active center">
  <h1>üöÄ Finanz-T√úV</h1>
  <p>Mach deinen pers√∂nlichen Finanz-Check: Einnahmen, Ausgaben, Schulden und Ziele analysieren ‚Äì √ºbersichtlich und modern.</p>
  <button class="btn" onclick="showPage('wizard')">Jetzt starten</button>
</div>

<!-- Wizard -->
<div id="wizard" class="page">
  <h2>Deine Eingaben</h2>
  <div id="step1" class="panel step">
    <label>Einkommen (Netto/Monat ‚Ç¨)</label>
    <input type="number" id="income" placeholder="z. B. 3200">
    <div class="nav"><span></span><button class="btn" onclick="nextStep(2)">Weiter</button></div>
  </div>
  <div id="step2" class="panel step" style="display:none">
    <label>Fixkosten (Miete, Nebenkosten etc. ‚Ç¨/Monat)</label>
    <input type="number" id="fixed" placeholder="z. B. 1800">
    <div class="nav"><button class="btn" onclick="nextStep(1)">Zur√ºck</button><button class="btn" onclick="nextStep(3)">Weiter</button></div>
  </div>
  <div id="step3" class="panel step" style="display:none">
    <label>Kreditrate (‚Ç¨/Monat)</label>
    <input type="number" id="debt" placeholder="z. B. 250">
    <label>Notgroschen (Betrag ‚Ç¨)</label>
    <input type="number" id="emerg" placeholder="z. B. 5000">
    <div class="nav"><button class="btn" onclick="nextStep(2)">Zur√ºck</button><button class="btn" onclick="nextStep(4)">Weiter</button></div>
  </div>
  <div id="step4" class="panel step" style="display:none">
    <label>Wunsch-Rente (Netto ‚Ç¨/Monat)</label>
    <input type="number" id="retire" placeholder="z. B. 2000">
    <div class="nav"><button class="btn" onclick="nextStep(3)">Zur√ºck</button><button class="btn" onclick="finish()">Analyse anzeigen</button></div>
  </div>
</div>

<!-- Ergebnisse -->
<div id="results" class="page">
  <h2>Deine Ergebnisse</h2>
  <div class="kpis" id="kpis"></div>
  <canvas id="pie" width="300" height="300"></canvas>
  <p id="legend"></p>
  <canvas id="spark" width="300" height="80"></canvas>
  <div class="panel">
    <h3>Mini-Ma√ünahmenplan</h3>
    <ul id="plan"></ul>
  </div>
  <div class="center"><button class="btn" onclick="showPage('landing')">Neu starten</button></div>
</div>

<script>
let state={income:0,fixed:0,debt:0,emerg:0,retire:0};

function showPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function nextStep(n){
  document.querySelectorAll('.step').forEach(s=>s.style.display="none");
  document.getElementById("step"+n).style.display="block";
}

function finish(){
  state.income=+document.getElementById('income').value||0;
  state.fixed=+document.getElementById('fixed').value||0;
  state.debt=+document.getElementById('debt').value||0;
  state.emerg=+document.getElementById('emerg').value||0;
  state.retire=+document.getElementById('retire').value||0;
  renderResults();
  showPage('results');
}

function euro(n){return (isFinite(n)?n:0).toLocaleString('de-DE',{style:'currency',currency:'EUR',maximumFractionDigits:0});}

function renderResults(){
  const totalExp=state.fixed+state.debt;
  const surplus=state.income-totalExp;
  const savingsRate=state.income?surplus/state.income:0;
  const dti=state.income?state.debt/state.income:0;
  const runway=totalExp?state.emerg/totalExp:0;
  const expectedState=state.income*0.40;
  const pensionGap=Math.max(state.retire-expectedState,0);
  const capNeed=pensionGap? pensionGap*12/0.035:0;

  const kpiHTML=`
    <div class="kpi"><div class="lab">√úberschuss</div><div class="val">${euro(surplus)}</div></div>
    <div class="kpi"><div class="lab">Sparquote</div><div class="val">${Math.round(savingsRate*100)}%</div></div>
    <div class="kpi"><div class="lab">Schuldenquote</div><div class="val">${Math.round(dti*100)}%</div></div>
    <div class="kpi"><div class="lab">Runway</div><div class="val">${runway.toFixed(1)} Mo</div></div>
  `;
  document.getElementById('kpis').innerHTML=kpiHTML;

  const ctx=document.getElementById('pie').getContext('2d');
  const data=[state.fixed,state.debt,Math.max(surplus,0)];
  const colors=['#60a5fa','#fb923c','#34d399'];
  const total=data.reduce((a,b)=>a+b,0)||1;
  let start=-Math.PI/2;
  ctx.clearRect(0,0,300,300);
  data.forEach((v,i)=>{
    const ang=v/total*2*Math.PI;
    ctx.beginPath();
    ctx.moveTo(150,150);
    ctx.arc(150,150,140,start,start+ang);
    ctx.fillStyle=colors[i];
    ctx.fill();
    start+=ang;
  });
  document.getElementById('legend').innerText=`Fixkosten ${euro(state.fixed)}, Schulden ${euro(state.debt)}, √úberschuss ${euro(Math.max(surplus,0))}`;

  const sctx=document.getElementById('spark').getContext('2d');
  sctx.clearRect(0,0,300,80);
  sctx.beginPath();sctx.strokeStyle=colors[2];sctx.moveTo(0,80);
  for(let i=0;i<=12;i++){let y=80-(surplus*i/Math.max(surplus*12,1))*70; sctx.lineTo(i*25,y);}
  sctx.stroke();

  const plan=[];
  if(runway<6) plan.push(`Notgroschen erh√∂hen (aktuell ${runway.toFixed(1)} Monate).`);
  if(savingsRate<0.1) plan.push("Mehr sparen, Ziel >10% Netto.");
  if(dti>0.35) plan.push("Schuldenquote hoch ‚Äì Tilgung/Umschuldung pr√ºfen.");
  if(pensionGap>0) plan.push(`Rentenl√ºcke ~${euro(pensionGap)} ‚áí Kapitalbedarf ~${euro(capNeed)}.`);
  if(plan.length===0) plan.push("Sehr solide Finanzen ‚Äì weiter so!");
  document.getElementById('plan').innerHTML=plan.map(p=>`<li>${p}</li>`).join('');
}
</script>

</body>
</html>
